<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>School Template - 9 Texts</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }

        #container {
            position: relative;
            width: 900px;
            height: 600px;
            margin: 20px auto;
            border: 2px dashed #aaa;
            overflow: hidden;
            background: white;
        }

        #template-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .text-overlay {
            position: absolute;
            cursor: move;
            user-select: none;
            padding: 5px;
            min-width: 50px;
            min-height: 20px;
            white-space: nowrap;
            /* optional: para di muna mag-wrap habang inaayos */
        }

        .selected {
            outline: 2px dashed #007bff;
            outline-offset: 2px;
        }

        #controls {
            max-width: 900px;
            margin: 20px auto;
            padding: 15px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }

        #controls.show {
            display: block;
        }

        .control-group {
            margin: 10px 0;
        }

        label {
            display: inline-block;
            width: 140px;
        }

        button {
            margin-top: 15px;
            padding: 8px 16px;
        }
    </style>
</head>

<body>

    <h2 style="text-align:center;">School Certificate Editor (9 Texts)</h2>

    <div id="container">
        <img id="template-img"
            src="https://via.placeholder.com/900x600/eeeeee/666666?text=Your+Certificate+Template+Here" alt="Template">

        <!-- 9 Text Fields -->
        <div id="text-name" class="text-overlay" style="top: 100px; left: 150px; font-size: 40px; font-weight: bold;">
            Juan Dela Cruz</div>
        <div id="text-grade" class="text-overlay" style="top: 160px; left: 150px; font-size: 30px;">Grade 10</div>
        <div id="text-section" class="text-overlay" style="top: 210px; left: 150px; font-size: 28px;">Section: Sapphire
        </div>
        <div id="text-school" class="text-overlay" style="top: 100px; left: 500px; font-size: 28px; color: #333;">XYZ
            National High School</div>
        <div id="text-award" class="text-overlay"
            style="top: 160px; left: 500px; font-size: 32px; font-weight: bold; color: #d4af37;">With Honors</div>
        <div id="text-year" class="text-overlay" style="top: 210px; left: 500px; font-size: 26px;">School Year 2025-2026
        </div>
        <div id="text-principal" class="text-overlay" style="top: 400px; left: 150px; font-size: 24px;">Principal: Dr.
            Maria Santos</div>
        <div id="text-adviser" class="text-overlay" style="top: 450px; left: 150px; font-size: 24px;">Adviser: Mr. John
            Reyes</div>
        <div id="text-date" class="text-overlay" style="top: 500px; left: 500px; font-size: 24px;">Date: March 30, 2026
        </div>
    </div>

    <div id="controls">
        <h3>Editing: <span id="editing-label">None</span></h3>

        <div class="control-group">
            <label>Font Size:</label>
            <input type="range" id="font-size" min="12" max="80" value="36">
            <span id="font-size-val">36px</span>
        </div>

        <div class="control-group">
            <label>Color:</label>
            <input type="color" id="color" value="#000000">
        </div>

        <div class="control-group">
            <label>Bold:</label>
            <input type="checkbox" id="bold" checked>
        </div>

        <div class="control-group">
            <label>Width (for wrapping):</label>
            <input type="range" id="width" min="100" max="700" value="400">
            <span id="width-val">400px</span>
        </div>

        <button id="reset">Reset All to Default</button>
    </div>

    <script>
        // Listahan ng lahat ng 9 texts
        const texts = {
            'text-name': { el: document.getElementById('text-name'), label: 'Student Name' },
            'text-grade': { el: document.getElementById('text-grade'), label: 'Grade Level' },
            'text-section': { el: document.getElementById('text-section'), label: 'Section' },
            'text-school': { el: document.getElementById('text-school'), label: 'School Name' },
            'text-award': { el: document.getElementById('text-award'), label: 'Award' },
            'text-year': { el: document.getElementById('text-year'), label: 'School Year' },
            'text-principal': { el: document.getElementById('text-principal'), label: 'Principal' },
            'text-adviser': { el: document.getElementById('text-adviser'), label: 'Adviser' },
            'text-date': { el: document.getElementById('text-date'), label: 'Date' }
        };

        let selected = null;

        function loadStyles() {
            const saved = JSON.parse(localStorage.getItem('templateStyles') || '{}');
            Object.keys(texts).forEach(id => {
                if (saved[id]) {
                    const s = saved[id];
                    const el = texts[id].el;
                    el.style.fontSize = s.fontSize || '';
                    el.style.color = s.color || '';
                    el.style.fontWeight = s.fontWeight || '';
                    el.style.width = s.width || '';
                    el.style.left = s.left || '';
                    el.style.top = s.top || '';
                }
            });
        }

        function saveStyles() {
            const data = {};
            Object.keys(texts).forEach(id => {
                const el = texts[id].el;
                data[id] = {
                    fontSize: el.style.fontSize,
                    color: el.style.color,
                    fontWeight: el.style.fontWeight,
                    width: el.style.width,
                    left: el.style.left,
                    top: el.style.top
                };
            });
            localStorage.setItem('templateStyles', JSON.stringify(data));
        }

        function selectText(id) {
            if (selected) texts[selected].el.classList.remove('selected');
            selected = id;
            if (id) {
                texts[id].el.classList.add('selected');
                document.getElementById('editing-label').textContent = texts[id].label;
                document.getElementById('controls').classList.add('show');

                const el = texts[id].el;
                document.getElementById('font-size').value = parseInt(el.style.fontSize || 24);
                document.getElementById('font-size-val').textContent = el.style.fontSize || '24px';
                document.getElementById('color').value = el.style.color ? rgbToHex(el.style.color) : '#000000';
                document.getElementById('bold').checked = (el.style.fontWeight || 'normal') === 'bold';
                document.getElementById('width').value = parseInt(el.style.width || 400);
                document.getElementById('width-val').textContent = el.style.width || '400px';
            } else {
                document.getElementById('controls').classList.remove('show');
            }
        }

        document.getElementById('container').addEventListener('click', (e) => {
            if (e.target === document.getElementById('template-img')) {
                selectText(null);
            }
        });

        // Setup click + drag for ALL texts (automatic dahil sa loop)
        Object.keys(texts).forEach(id => {
            const el = texts[id].el;

            el.addEventListener('click', (e) => {
                e.stopPropagation();
                selectText(id);
            });

            let isDragging = false;
            let offsetX, offsetY;

            el.addEventListener('mousedown', (e) => {
                isDragging = true;
                offsetX = e.clientX - el.getBoundingClientRect().left;
                offsetY = e.clientY - el.getBoundingClientRect().top;
                selectText(id);
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging && selected === id) {
                    const containerRect = document.getElementById('container').getBoundingClientRect();
                    let newLeft = e.clientX - containerRect.left - offsetX;
                    let newTop = e.clientY - containerRect.top - offsetY;

                    newLeft = Math.max(0, Math.min(newLeft, containerRect.width - el.offsetWidth));
                    newTop = Math.max(0, Math.min(newTop, containerRect.height - el.offsetHeight));

                    el.style.left = newLeft + 'px';
                    el.style.top = newTop + 'px';
                    saveStyles();
                }
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        });

        // Controls
        document.getElementById('font-size').addEventListener('input', (e) => {
            if (!selected) return;
            const val = e.target.value + 'px';
            texts[selected].el.style.fontSize = val;
            document.getElementById('font-size-val').textContent = val;
            saveStyles();
        });

        document.getElementById('color').addEventListener('input', (e) => {
            if (!selected) return;
            texts[selected].el.style.color = e.target.value;
            saveStyles();
        });

        document.getElementById('bold').addEventListener('change', (e) => {
            if (!selected) return;
            texts[selected].el.style.fontWeight = e.target.checked ? 'bold' : 'normal';
            saveStyles();
        });

        document.getElementById('width').addEventListener('input', (e) => {
            if (!selected) return;
            const val = e.target.value + 'px';
            texts[selected].el.style.width = val;
            texts[selected].el.style.whiteSpace = 'normal'; // enable wrapping
            document.getElementById('width-val').textContent = val;
            saveStyles();
        });

        document.getElementById('reset').addEventListener('click', () => {
            if (confirm('Sure ka? Mawawala lahat ng custom positions at styles.')) {
                localStorage.removeItem('templateStyles');
                location.reload();
            }
        });

        function rgbToHex(rgb) {
            if (rgb.startsWith('#')) return rgb;
            const match = rgb.match(/\d+/g);
            if (!match) return '#000000';
            return '#' + match.map(x => parseInt(x).toString(16).padStart(2, '0')).join('');
        }

        loadStyles();
    </script>
</body>

</html>